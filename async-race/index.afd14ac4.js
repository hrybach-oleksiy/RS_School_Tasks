(()=>{"use strict";var t={385:t=>{t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),e.hash&&(t+=e.hash),e.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(t)?'"'.concat(t,'"'):t):t}},875:(t,e,r)=>{t.exports=r.p+"images/favicon-32x32.4bbb5e58.png"}},e={};function r(n){var s=e[n];if(void 0!==s)return s.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,r),a.exports}r.m=t,r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var s=n.length-1;s>-1&&(!t||!/^http(s?):/.test(t));)t=n[s--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t})(),r.b=document.baseURI||self.location.href;var n={};(()=>{r.r(n);var t,e,s,a,i,o=r(385),l=r.n(o),c=new URL(r(875),r.b);l()(c);class h{constructor({tag:t="div",classNames:e=[],text:r=""},...n){this.children=[];const s=document.createElement(t);s.classList.add(...e),s.textContent=r,this.node=s,n&&this.appendChildren(n)}append(t){this.children.push(t),this.node.append(t.getNode())}appendChildren(t){t.forEach((t=>{this.append(t)}))}getNode(){return this.node}getChildren(){return this.children}setTextContent(t){this.node.textContent=t}setAttribute(t,e){this.node.setAttribute(t,e)}setAttributes(t){Object.keys(t).forEach((e=>{this.node.setAttribute(e,t[e])}))}getAttribute(t){return this.node.getAttribute(t)}removeAttribute(t){this.node.removeAttribute(t)}addClass(t){this.node.classList.add(t)}removeClass(t){this.node.classList.remove(t)}toggleClass(t){this.node.classList.toggle(t)}addListener(t,e,r=!1){this.node.addEventListener(t,e,r)}removeListener(t,e,r=!1){this.node.removeEventListener(t,e,r)}destroyChildren(){this.children.forEach((t=>{t.destroy()})),this.children.length=0}destroy(){this.destroyChildren(),this.node.remove()}}!function(t){t.GARAGE="garage",t.ENGINE="engine",t.WINNERS="winners"}(t||(t={})),function(t){t.GET="GET",t.DELETE="DELETE",t.PUT="PUT",t.POST="POST",t.PATCH="PATCH"}(e||(e={})),function(t){t.PLACEHOLDER="placeholder",t.TYPE="type",t.NAME="name",t.ID="id",t.FOR="for",t.REQUIRED="required",t.ACTION="action",t.DISABLED="disabled",t.CHECKED="checked",t.VALUE="value",t.SELECTED="selected"}(s||(s={})),function(t){t.SRC="src",t.ALT="alt"}(a||(a={})),function(t){t.HREF="href",t.TARGET="target"}(i||(i={}));class d extends h{constructor({classNames:t,id:e,type:r="text",name:n,placeholder:a,required:i,checked:o,onChange:l}){super({tag:"input",classNames:t}),this.setAttribute(s.ID,e),this.setAttribute(s.TYPE,r),this.setAttribute(s.NAME,n),a&&this.setAttribute(s.PLACEHOLDER,a),o&&this.setAttribute(s.CHECKED,o),i&&this.setAttribute(s.REQUIRED,i),l&&(this.onChange=l,this.addListener("input",this.onChange))}destroy(){this.onChange&&(this.removeListener("input",this.onChange),super.destroy())}}class u extends h{constructor({classNames:t,text:e,onClick:r}){super({tag:"button",classNames:t,text:e}),r&&(this.onClick=r,this.addListener("click",this.onClick))}destroy(){this.onClick&&(this.removeListener("click",this.onClick),super.destroy())}}const m=(t,...e)=>new h({tag:"div",classNames:t},...e),p=(t,e)=>new h({tag:"h1",classNames:t,text:e}),g=(t,e)=>new h({tag:"h2",classNames:t,text:e}),C=(t,e)=>new h({tag:"span",classNames:t,text:e}),w=(t,e,r,n,s,a,i)=>new d({classNames:t,id:e,name:r,type:n,placeholder:s,required:a,onChange:i}),b=(t,e,r)=>new u({classNames:t,text:e,onClick:r}),E=t=>new h({tag:"img",classNames:t}),A=t=>new h({tag:"a",classNames:t}),N="Header-module_active_liiKt1";class y extends h{constructor(){super({tag:"header",classNames:["Header-module_header_uNX8Ji"]},new h({tag:"p",classNames:["Header-module_header-title_Ryd7lg"],text:"Async Race"})),this.setContent()}setContent(){const t=m(["Header-module_wrapper_xhbvNE"]),e=b(["btn","header-btn"],"Garage",y.changeView);e.addClass(N);const r=b(["btn","header-btn","winner-btn"],"Winners",y.changeView);t.appendChildren([e,r]),this.append(t)}}y.changeView=t=>{const e=t.target,r=document.querySelectorAll(".page"),n=document.querySelectorAll(".header-btn"),s=e.textContent;"Garage"===s&&(r[1].classList.add("hidden"),r[0].classList.remove("hidden")),"Winners"===s&&(r[0].classList.add("hidden"),r[1].classList.remove("hidden")),n.forEach((t=>{t.classList.contains(N)?t.classList.remove(N):t.classList.add(N)}))};const S=y,B=r.p+"images/school-logo.ad178c0d.svg",v=r.p+"images/github-logo.1bc6258a.svg",L="footer-module_link_DKbGIh",f="footer-module_img_MrQMNV";class k extends h{constructor(){super({tag:"footer",classNames:["footer-module_footer_rlM2_G"]}),this.setBlock()}setBlock(){const t=m(["footer-module_copyright_JpZXSY"]),e=A([L]),r=A([L]),n=C(["copy"],"Â© 2024, by Hrybach Oleksiy"),s=E([f]),o=E([f]);e.setAttribute(i.HREF,"https://github.com/hrybach-oleksiy"),e.setAttribute(i.TARGET,"_blank"),r.setAttribute(i.HREF,"https://rs.school/js/"),r.setAttribute(i.TARGET,"_blank"),s.setAttribute(a.SRC,v),s.setAttribute(a.ALT,"GitHub Logo"),o.setAttribute(a.SRC,B),o.setAttribute(a.ALT,"RS School Logo"),e.append(s),r.append(o),t.appendChildren([e,r,n]),this.append(t)}}const T="Pagination-module_button_SP8jE_";class x extends h{constructor(t,e,r){super({tag:"div",classNames:["Pagination-module_pagination_VGHUYe"]}),this.onPrevBtnClick=t,this.onNextBtnClick=e,this.isNextBtnActive=r,this.setBlock()}setBlock(){const t=b(["btn",T,"prevBtn"],"Previous Page",(t=>{this.onPrevBtnClick(t)})),e=b(["btn",T,"nextBtn"],"Next Page",(t=>{this.onNextBtnClick(t)}));t.setAttribute(s.DISABLED,"true"),this.isNextBtnActive?e.removeAttribute(s.DISABLED):e.setAttribute(s.DISABLED,"true"),this.appendChildren([t,e])}}const D=["Toyota","Honda","Chevrolet","Ford","Volkswagen","BMW","Mercedes-Benz","Audi","Nissan","Hyundai","Kia","Volvo","Lexus","Subaru","Mazda","Jeep","Tesla","Porsche","Ferrari","Lamborghini","Maserati","Bugatti","McLaren","Bentley","Rolls-Royce","Aston Martin","Jaguar","Land Rover","Alfa Romeo","Fiat","Chrysler","Dodge","Mitsubishi","Buick","Cadillac","Infiniti","Acura","Lincoln","GMC","RAM","Mini","Smart","Suzuki","Pontiac","Hummer","Oldsmobile","Saab"],_=["Camry","Accord","Silverado","F-150","Golf","3 Series","E-Class","A4","Altima","Elantra","Sorento","XC90","RX","Outback","CX-5","Grand Cherokee","Model 3","911","488 GTB","Huracan","GranTurismo","Chiron","720S","Continental GT","Phantom","DB11","F-Type","Range Rover","Giulia","500","300","Challenger","Outlander","Encore","Escalade","QX80","MDX","Navigator","Sierra","1500","Countryman","Fortwo","Swift","Grand Prix","H2","Alero","9-3"],W=()=>{const t=Math.floor(Math.random()*D.length),e=Math.floor(Math.random()*_.length);return`${D[t]} ${_[e]}`},I=()=>{let t="#";for(let e=0;e<6;e+=1){const e=Math.floor(16*Math.random());t+="0123456789ABCDEF".charAt(e)}return t};class R{constructor(){this.garageLink=`http://127.0.0.1:3000/${t.GARAGE}`,this.engineLink=`http://127.0.0.1:3000/${t.ENGINE}`,this.winnerLink=`http://127.0.0.1:3000/${t.WINNERS}`,this.totalCars=0,this.totalWinners=0,this.getAllCars=async(t,r=7)=>{try{const n=await fetch(`${this.garageLink}?_page=${t}&_limit=${r}`,{method:e.GET});return this.totalCars=Number(n.headers.get("X-Total-count")),await n.json()}catch(t){throw console.error("Error occurred while fetching the list of cars:",t),t}},this.getCar=async t=>{try{const r=await fetch(`${this.garageLink}/${t}`,{method:e.GET});return await r.json()}catch(t){throw console.error("Error occurred while fetching the car:",t),t}},this.addCar=async t=>{try{await fetch(this.garageLink,{method:e.POST,body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})}catch(t){throw console.error("Error occurred while adding car to the Garage:",t),t}},this.updateCar=async t=>{try{await fetch(`${this.garageLink}/${t.id}`,{method:e.PUT,body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})}catch(t){throw console.error("Error occurred while updating car in the Garage:",t),t}},this.deleteCar=async t=>{try{await fetch(`${this.garageLink}/${t}`,{method:e.DELETE})}catch(t){throw console.error("Error occurred while deleting car from the Garage:",t),t}},this.startEngine=async t=>{try{const r=await fetch(`${this.engineLink}?id=${t}&status=started`,{method:e.PATCH});return await r.json()}catch(t){throw console.error("Error occurred while starting Engine:",t),t}},this.stopEngine=async t=>{try{const r=await fetch(`${this.engineLink}?id=${t}&status=stopped`,{method:e.PATCH});return await r.json()}catch(t){throw console.error("Error occurred while stopping Engine:",t),t}},this.driveEngine=async t=>{try{const r=await fetch(`${this.engineLink}?id=${t}&status=drive`,{method:e.PATCH});return 200!==r.status?{success:!1}:{...await r.json()}}catch(t){throw console.error("Error occurred while driving Engine:",t),t}},this.getAllWinners=async()=>{try{const t=await fetch(`${this.winnerLink}`,{method:e.GET});return await t.json()}catch(t){throw console.error("Error getting all winners:",t),t}},this.getWinners=async(t,r=10)=>{try{const n=await fetch(`${this.winnerLink}?_page=${t}&_limit=${r}`,{method:e.GET});return this.totalWinners=Number(n.headers.get("X-Total-count")),await n.json()}catch(t){throw console.error("Error getting winners:",t),t}},this.getWinner=async t=>{try{const r=await fetch(`${this.winnerLink}/${t}`,{method:e.GET});return await r.json()}catch(t){throw console.error("Error occurred while fetching the winner:",t),t}},this.addWinner=async t=>{try{await fetch(this.winnerLink,{method:e.POST,body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})}catch(t){throw console.error("Error occurred while adding winner to the List:",t),t}},this.deleteWinner=async t=>{try{await fetch(`${this.winnerLink}/${t}`,{method:e.DELETE})}catch(t){throw console.error("Error occurred while deleting winner from the List:",t),t}},this.updateWinner=async t=>{try{await fetch(`${this.winnerLink}/${t.id}`,{method:e.PUT,body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})}catch(t){throw console.error("Error occurred while updating winner in the List:",t),t}}}get totalCarsValue(){return this.totalCars}get totalWinnersValue(){return this.totalWinners}async updateTotalCarsValue(){try{const t=await fetch(`${this.garageLink}`,{method:e.GET}),r=await t.json();this.totalCars=r.length}catch(t){console.error("Error updating total cars value:",t)}}async updateTotalWinnersValue(){try{const t=await fetch(`${this.winnerLink}`,{method:e.GET}),r=await t.json();this.totalWinners=r.length}catch(t){console.error("Error updating total winners value:",t)}}}const $=t=>`<svg fill="${t}" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 324.02 324.02" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M317.833,197.111c3.346-11.148,2.455-20.541-2.65-27.945c-9.715-14.064-31.308-15.864-35.43-16.076l-8.077-4.352 l-0.528-0.217c-8.969-2.561-42.745-3.591-47.805-3.733c-7.979-3.936-14.607-7.62-20.475-10.879 c-20.536-11.413-34.107-18.958-72.959-18.958c-47.049,0-85.447,20.395-90.597,23.25c-2.812,0.212-5.297,0.404-7.646,0.59 l-6.455-8.733l7.34,0.774c2.91,0.306,4.267-1.243,3.031-3.459c-1.24-2.216-4.603-4.262-7.519-4.57l-23.951-2.524 c-2.91-0.305-4.267,1.243-3.026,3.459c1.24,2.216,4.603,4.262,7.519,4.57l3.679,0.386l8.166,11.05 c-13.823,1.315-13.823,2.139-13.823,4.371c0,18.331-2.343,22.556-2.832,23.369L0,164.443v19.019l2.248,2.89 c-0.088,2.775,0.823,5.323,2.674,7.431c5.981,6.804,19.713,7.001,21.256,7.001c4.634,0,14.211-2.366,20.78-4.153 c-0.456-0.781-0.927-1.553-1.3-2.392c-0.36-0.809-0.603-1.668-0.885-2.517c-0.811-2.485-1.362-5.096-1.362-7.845 c0-14.074,11.449-25.516,25.515-25.516s25.52,11.446,25.52,25.521c0,6.068-2.221,11.578-5.773,15.964 c-0.753,0.927-1.527,1.828-2.397,2.641c-1.022,0.958-2.089,1.859-3.254,2.641c29.332,0.109,112.164,0.514,168.708,1.771 c-0.828-0.823-1.533-1.771-2.237-2.703c-0.652-0.854-1.222-1.75-1.761-2.688c-2.164-3.744-3.5-8.025-3.5-12.655 c0-14.069,11.454-25.513,25.518-25.513c14.064,0,25.518,11.449,25.518,25.513c0,5.126-1.553,9.875-4.152,13.878 c-0.605,0.922-1.326,1.755-2.04,2.594c-0.782,0.922-1.616,1.781-2.527,2.584c5.209,0.155,9.699,0.232,13.546,0.232 c19.563,0,23.385-1.688,23.861-5.018C324.114,202.108,324.472,199.602,317.833,197.111z"></path> <path d="M52.17,195.175c3.638,5.379,9.794,8.922,16.756,8.922c0.228,0,0.44-0.062,0.663-0.073c2.576-0.083,5.043-0.61,7.291-1.574 c1.574-0.678,2.996-1.6,4.332-2.636c4.782-3.702,7.927-9.429,7.927-15.933c0-11.144-9.066-20.216-20.212-20.216 s-20.213,9.072-20.213,20.216c0,2.263,0.461,4.411,1.149,6.446c0.288,0.85,0.616,1.673,1.015,2.471 C51.279,193.606,51.667,194.434,52.17,195.175z"></path> <path d="M269.755,209.068c2.656,0,5.173-0.549,7.503-1.481c1.589-0.642,3.06-1.491,4.422-2.495 c1.035-0.767,1.988-1.616,2.863-2.559c3.34-3.604,5.432-8.389,5.432-13.681c0-11.144-9.071-20.21-20.215-20.21 s-20.216,9.066-20.216,20.21c0,4.878,1.812,9.3,4.702,12.801c0.818,0.989,1.719,1.89,2.708,2.713 c1.311,1.088,2.729,2.024,4.293,2.755C263.836,208.333,266.704,209.068,269.755,209.068z"></path> </g> </g> </g></svg>\n`,G="CarBlock-module_car-options_WEvWo3",P="CarBlock-module_button_A_r_Sg";class H extends h{constructor(t,e,r){super({tag:"div",classNames:["CarBlock-module_car-wrapper_sj9AdZ","car-wrapper-js"]}),this.startButton=b(["btn",P],"Start",(t=>{this.handleStartCarClick(t)})),this.stopButton=b(["btn",P],"Stop",(t=>{this.handleStopCarClick(t)})),this.handleStartCarClick=async t=>{const e=t.target,r=Number(e.dataset.start);this.startButton.setAttribute(s.DISABLED,"true"),this.stopButton.removeAttribute(s.DISABLED),this.startRaceHandler(r)},this.handleStopCarClick=async t=>{const e=t.target,r=Number(e.dataset.stop);this.stopButton.setAttribute(s.DISABLED,"true"),this.startButton.removeAttribute(s.DISABLED),this.stopRaceHandler(r)},this.carProps=t,this.startRaceHandler=e,this.stopRaceHandler=r,this.setBlock()}setBlock(){const{id:t,name:e,color:r}=this.carProps,n=m([G]),a=b(["btn",P,"update"],"Update Car"),i=b(["btn",P,"remove"],"Remove Car"),o=new h({tag:"h3",classNames:["CarBlock-module_car-title_wkCFXh"],text:e});a.setAttribute("data-update",String(t)),i.setAttribute("data-remove",String(t)),n.appendChildren([a,i,o]);const l=m(["CarBlock-module_car-controls_lCuZfz"]),c=m(["CarBlock-module_img-wrapper_OTbyBK"]),d=m(["CarBlock-module_finish-flag_mE7QH5"]);this.stopButton.setAttribute(s.DISABLED,"true"),c.getNode().insertAdjacentHTML("beforeend",$(r)),this.startButton.setAttribute("data-start",String(t)),this.stopButton.setAttribute("data-stop",String(t)),c.setAttribute("data-car",String(t)),l.appendChildren([this.startButton,this.stopButton,c,d]),this.appendChildren([n,l])}}const M={col:"WinnerBlock-module_col_zExb8t"};class j extends h{constructor(t){super({tag:"tr",classNames:[M["winner-row"]]}),this.winnerProps=t,this.setBlock()}setBlock(){const{time:t,wins:e,name:r,color:n,winnerNumber:s}=this.winnerProps,a=new h({tag:"td",classNames:[M.col],text:String(s)}),i=new h({tag:"td",classNames:[M.col]}),o=new h({tag:"td",classNames:[M.col],text:r}),l=new h({tag:"td",classNames:[M.col],text:String(t)}),c=new h({tag:"td",classNames:[M.col],text:String(e)});i.getNode().insertAdjacentHTML("beforeend",$(n)),this.appendChildren([a,i,o,c,l])}}class V{constructor(){this.model=new R}static renderCars(t,e,r,n){e.destroyChildren(),t.forEach((t=>{const s={id:t.id,name:t.name,color:t.color},a=new H(s,r,n);e&&e.append(a)}))}renderWinners(t,e){const r=document.querySelector(".winners .page-number-count"),n=r?.textContent?.slice(1),s=e;let a=10*Number(n)-10;s.innerHTML="",t.forEach((async t=>{const e=await this.model.getCar(t.id);a+=1;const r={id:t.id,winnerNumber:a,wins:t.wins,time:t.time,name:e.name,color:e.color},n=new j(r);s.append(n.getNode())}))}}function q(t){if(null==t)throw new Error(`${t} is not defined`)}class O{constructor(){this.model=new R,this.view=new V,this.animatedCars={},this.winnerCar=null,this.winsCount=1,this.handleStartCar=async t=>{const e=document.querySelector(".car-wrapper-js"),r=document.querySelector(`[data-car="${t}"]`),n=e.clientWidth-(r.offsetLeft-e.offsetLeft+r.offsetWidth),s=document.querySelector(".winner-message-js");q(s);try{const e=await this.model.startEngine(t),a=Number(e.velocity),i=Number(e.distance)/a;if(this.animatedCars[t]=((t,e,r)=>{const n={},s=t;let a=0;return n.id=window.requestAnimationFrame((function t(i){a||(a=i);const o=(i-a)/r,l=o*e;s.style.transform=`translateX(${l}px)`,o<1&&(n.id=window.requestAnimationFrame(t))})),n})(r,n,i),(await this.model.driveEngine(t)).success){if(null===this.winnerCar){let e=(i/1e3).toFixed(2);const r=await this.model.getCar(t),n=r.name;this.winnerCar={time:i,id:t},s.textContent=`${n} wins the race for ${e} seconds`;const a=await this.model.getWinner(t);0!==Object.keys(a).length&&(this.winsCount=a.wins,this.winsCount+=1),a.time<e&&(e=a.time);const o={id:t,time:Number(e),wins:this.winsCount,name:r.name,color:r.color};this.winsCount>1?(console.log("update winner works"),this.model.updateWinner(o)):(console.log("add winner works"),await this.model.addWinner(o)),setTimeout((()=>{s.textContent=""}),4e3),console.log(`${n} wins the race for ${e} seconds`)}}else window.cancelAnimationFrame(this.animatedCars[t].id)}catch(t){console.error("Error starting car:",t)}},this.handleStopCar=async t=>{try{await this.model.stopEngine(Number(t)),window.cancelAnimationFrame(this.animatedCars[t].id),document.querySelector(`[data-car="${t}"]`).style.transform="translateX(0px)"}catch(t){console.error("Error stopping car:",t)}},this.handleStartRace=async t=>{const e=document.querySelector(".btn-race"),r=document.querySelector(".btn-reset");e?.setAttribute(s.DISABLED,"true");const n=(await this.model.getAllCars(t)).map((t=>this.handleStartCar(Number(t.id))));try{await Promise.all(n),r?.removeAttribute(s.DISABLED)}catch(t){console.error("Error while racing:",t)}},this.handleStopRace=async t=>{const e=document.querySelector(".btn-race"),r=document.querySelector(".btn-reset");(await this.model.getAllCars(t)).forEach((t=>{this.handleStopCar(Number(t.id))})),this.winnerCar=null,e?.removeAttribute(s.DISABLED),r?.setAttribute(s.DISABLED,"true")},this.handleSortWinners=async(t,e,r)=>{const n=await this.model.getAllWinners();let s;var a;t?(a=r,s=n.slice().sort(((t,e)=>Number(t[a])-Number(e[a]))),this.view.renderWinners(s,e)):(s=((t,e)=>t.slice().sort(((t,r)=>{const n=Number(t[e]);return Number(r[e])-n})))(n,r),this.view.renderWinners(s,e))}}async handleDeleteButton(t,e,r){const n=document.querySelector(".total-cars");await this.model.deleteCar(t);const s=await this.model.getAllCars(r);V.renderCars(s,e,this.handleStartCar,this.handleStopCar),n&&(n.textContent=`(${this.model.totalCarsValue})`)}async handleCreateButton(t,e,r,n){await this.model.addCar(t);const s=await this.model.getAllCars(r);V.renderCars(s,e,this.handleStartCar,this.handleStopCar),n.setTextContent(`(${this.model.totalCarsValue})`)}async handleUpdateButton(t,e,r,n){await this.model.updateCar(t);const s=await this.model.getAllCars(r);V.renderCars(s,e,this.handleStartCar,this.handleStopCar),n.setTextContent(`(${this.model.totalCarsValue})`)}async handleRenderCars(t,e,r){const n=await this.model.getAllCars(e);V.renderCars(n,t,this.handleStartCar,this.handleStopCar),r.setTextContent(`(${this.model.totalCarsValue})`)}async handleRenderWinners(t,e,r){const n=await this.model.getWinners(e);this.view.renderWinners(n,t),r?.setTextContent(`(${this.model.totalWinnersValue})`)}}const U="Garage-module_input-text_UkUgdv",F="Garage-module_button_niKgWd";class X extends h{constructor(){super({tag:"div",classNames:["Garage-module_garage_ffspY_","page"]}),this.controller=new O,this.model=new R,this.pageNumber=1,this.totalCarsElement=C(["total-cars"],""),this.carsWrapper=m(["Garage-module_cars-wrapper_xQMbdA","test-car-wrapper"]),this.createCarInputText=w([U],"create-car-text","create-car=text","text","Enter Car Name"),this.createCarInputColor=w(["input-color"],"create-car-color","create-car-color","color"),this.updateCarInputText=w([U],"update-car-text","update-car=text","text","Enter New Car Name"),this.updateCarInputColor=w(["input-color"],"update-car-color","update-car-color","color"),this.updateButton=b(["btn",F],"Update Car"),this.pageNumberCountElement=C(["page-number-count"],`#${this.pageNumber}`),this.updatedID=0,this.handleCarOptionsClick=async t=>{const e=t.target;if(e.classList.contains("remove")&&e.closest(`.${G}`)){const t=e.dataset.remove;await this.controller.handleDeleteButton(Number(t),this.carsWrapper,this.pageNumber),await this.model.deleteWinner(Number(t))}if(e.classList.contains("update")&&e.closest(`.${G}`)){const t=e.dataset.update;this.updatedID=Number(t),this.model.getCar(Number(t)).then((t=>{this.updateCarInputText.getNode().value=t.name,this.updateCarInputColor.getNode().value=t.color})),this.updateCarInputText.removeAttribute(s.DISABLED),this.updateCarInputColor.removeAttribute(s.DISABLED),this.updateButton.removeAttribute(s.DISABLED)}},this.handleCreateButtonClick=async()=>{const t=this.createCarInputText.getNode().value,e=this.createCarInputColor.getNode().value;if(!t)return;const r={name:t,color:e};if(await this.model.updateTotalCarsValue(),await this.controller.handleCreateButton(r,this.carsWrapper,this.pageNumber,this.totalCarsElement),this.model.totalCarsValue>=7*this.pageNumber){const t=document.querySelector(".nextBtn");t?.removeAttribute(s.DISABLED)}this.createCarInputText.getNode().value="",this.createCarInputColor.getNode().value="#000000"},this.handleUpdateButtonClick=()=>{const t={name:this.updateCarInputText.getNode().value,color:this.updateCarInputColor.getNode().value,id:this.updatedID};this.controller.handleUpdateButton(t,this.carsWrapper,this.pageNumber,this.totalCarsElement),this.updateButton.setAttribute(s.DISABLED,"true"),this.updateCarInputText.setAttribute(s.DISABLED,"true"),this.updateCarInputColor.setAttribute(s.DISABLED,"true"),this.updateCarInputText.getNode().value="",this.updateCarInputColor.getNode().value="#000000"},this.handlePrevButtonClick=t=>{const e=t.target,r=document.querySelector(".nextBtn");r?.removeAttribute(s.DISABLED),e.removeAttribute(s.DISABLED),this.pageNumber-=1,this.pageNumberCountElement.setTextContent(`#${this.pageNumber}`),1===this.pageNumber&&e.setAttribute(s.DISABLED,"true"),this.controller.handleRenderCars(this.carsWrapper,this.pageNumber,this.totalCarsElement)},this.handleNextButtonClick=async t=>{const e=t.target;await this.model.updateTotalCarsValue();const r=document.querySelector(".prevBtn");r?.removeAttribute(s.DISABLED),e.removeAttribute(s.DISABLED),this.pageNumber+=1,this.pageNumberCountElement.setTextContent(`#${this.pageNumber}`),7*this.pageNumber>=this.model.totalCarsValue&&e.setAttribute(s.DISABLED,"true"),await this.controller.handleRenderCars(this.carsWrapper,this.pageNumber,this.totalCarsElement)},this.handleGenerateButtonClick=async()=>{const t=document.querySelector(".nextBtn"),e=[];for(let t=0;t<100;t+=1){const t={name:W(),color:I()};e.push(this.model.addCar(t))}await Promise.all(e),await this.controller.handleRenderCars(this.carsWrapper,this.pageNumber,this.totalCarsElement),t?.removeAttribute(s.DISABLED)},this.handleRaceButtonClick=()=>{this.controller.handleStartRace(this.pageNumber)},this.handleResetButtonClick=()=>{this.controller.handleStopRace(this.pageNumber)},this.init(),this.addListener("click",this.handleCarOptionsClick)}async init(){await this.model.updateTotalCarsValue(),await this.controller.handleRenderCars(this.carsWrapper,this.pageNumber,this.totalCarsElement),this.setContent()}setContent(){const t=p(["Garage-module_title_gJAqBj"],"Garage  ");t.append(this.totalCarsElement);const e=g(["page-number-title"],"Page ");e.append(this.pageNumberCountElement);const r=this.setGenerateCarBlock(),n=this.model.totalCarsValue>7*this.pageNumber,s=new x(this.handlePrevButtonClick,this.handleNextButtonClick,n),a=m(["Garage-module_winner-message_aU__lQ","winner-message-js"]);this.appendChildren([r,t,e,this.carsWrapper,s,a])}setGenerateCarBlock(){const t=m(["Garage-module_generate-wrapper_kfvhxH"]),e=m(["Garage-module_create-wrapper_g8_2hz"]),r=b(["btn",F],"Create Car",this.handleCreateButtonClick);e.appendChildren([this.createCarInputText,this.createCarInputColor,r]);const n=m(["Garage-module_update-wrapper_HbOEJA"]);this.updateCarInputText.setAttribute(s.DISABLED,"true"),this.updateCarInputColor.setAttribute(s.DISABLED,"true"),this.updateButton.setAttribute(s.DISABLED,"true"),this.updateButton.addListener("click",this.handleUpdateButtonClick),n.appendChildren([this.updateCarInputText,this.updateCarInputColor,this.updateButton]);const a=m(["Garage-module_controls-wrapper_HnN7GN"]),i=b(["btn",F,"btn-race"],"Start Race",this.handleRaceButtonClick),o=b(["btn",F,"btn-reset"],"Reset Race",this.handleResetButtonClick),l=b(["btn",F],"Generate Cars",this.handleGenerateButtonClick);return o.setAttribute(s.DISABLED,"true"),a.appendChildren([i,o,l]),t.appendChildren([e,n,a]),t}}const z="WinnersTable-module_asc_Xx2Hur",J="WinnersTable-module_clicked_ICb96P";class K extends h{constructor(){super({tag:"table",classNames:["WinnersTable-module_winners-table_TGhoEp"]}),this.controller=new O,this.isWinsAscending=!1,this.isTimeAscending=!1,this.tableContainer=new h({tag:"tbody",classNames:["table-container"]}),this.winsElement=new h({tag:"th",text:"Wins",classNames:["WinnersTable-module_wins_tYOe5p"]}),this.timeElement=new h({tag:"th",text:"Best Time",classNames:["WinnersTable-module_time_AzK_VW"]}),this.handleWinsClick=async()=>{this.timeElement.removeClass(z),this.winsElement.addClass(z),this.isWinsAscending?(await this.controller.handleSortWinners(this.isWinsAscending,this.tableContainer.getNode(),"wins"),this.winsElement.addClass(J),this.isWinsAscending=!1):(await this.controller.handleSortWinners(this.isWinsAscending,this.tableContainer.getNode(),"wins"),this.winsElement.removeClass(J),this.isWinsAscending=!0)},this.handleTimeClick=async()=>{this.winsElement.removeClass(z),this.timeElement.addClass(z),this.isTimeAscending?(await this.controller.handleSortWinners(this.isTimeAscending,this.tableContainer.getNode(),"time"),this.timeElement.addClass(J),this.isTimeAscending=!1):(await this.controller.handleSortWinners(this.isTimeAscending,this.tableContainer.getNode(),"time"),this.timeElement.removeClass(J),this.isTimeAscending=!0)},this.setContent()}setContent(){const t=new h({tag:"thead"}),e=new h({tag:"tr"}),r=new h({tag:"th",text:"#"}),n=new h({tag:"th",text:"Car"}),s=new h({tag:"th",text:"Name"});this.winsElement.addListener("click",this.handleWinsClick),this.timeElement.addListener("click",this.handleTimeClick),e.appendChildren([r,n,s,this.winsElement,this.timeElement]),t.append(e),this.appendChildren([t,this.tableContainer])}}const Q={title:"Winners-module_title_r1TsqE"};class Y extends h{constructor(){super({tag:"div",classNames:["winners","page"]}),this.controller=new O,this.model=new R,this.pageNumber=1,this.winnersWrapper=m([Q["winners-wrapper"]]),this.totalWinnersElement=C(["total-winners"],""),this.pageNumberCountElement=C(["page-number-count"],`#${this.pageNumber}`),this.handleWinnersPageClick=t=>{if(t.target.classList.contains("winner-btn")){const t=document.querySelector(".table-container");q(t),this.controller.handleRenderWinners(t,this.pageNumber,this.totalWinnersElement)}},this.handlePrevButtonClick=t=>{const e=t.target,r=document.querySelector(".winners .nextBtn"),n=document.querySelector(".table-container");q(n),console.log("winners next"),r?.removeAttribute(s.DISABLED),e.removeAttribute(s.DISABLED),this.pageNumber-=1,this.pageNumberCountElement.setTextContent(`#${this.pageNumber}`),1===this.pageNumber&&e.setAttribute(s.DISABLED,"true"),this.controller.handleRenderWinners(n,this.pageNumber,this.totalWinnersElement)},this.handleNextButtonClick=async t=>{const e=t.target,r=document.querySelector(".table-container");q(r),await this.model.updateTotalCarsValue();const n=document.querySelector(".winners .prevBtn");console.log("winners prev"),n?.removeAttribute(s.DISABLED),e.removeAttribute(s.DISABLED),this.pageNumber+=1,this.pageNumberCountElement.setTextContent(`#${this.pageNumber}`),10*this.pageNumber>=this.model.totalWinnersValue&&e.setAttribute(s.DISABLED,"true"),this.controller.handleRenderWinners(r,this.pageNumber,this.totalWinnersElement)},this.init(),document.addEventListener("click",(t=>{this.handleWinnersPageClick(t)}))}async init(){await this.model.updateTotalWinnersValue(),this.setContent()}setContent(){const t=p([Q.title],"Winners  "),e=g(["page-number-title"],"Page "),r=this.model.totalWinnersValue>10*this.pageNumber,n=new x(this.handlePrevButtonClick,this.handleNextButtonClick,r),s=new K;t.append(this.totalWinnersElement),e.append(this.pageNumberCountElement),this.appendChildren([t,e,this.winnersWrapper,s,n])}}class Z extends h{constructor(){super({tag:"main",classNames:["Main-module_main_d2LaAM"]}),this.setPage()}setPage(){this.destroyChildren();const t=new X,e=new Y;e.addClass("hidden"),this.appendChildren([t,e])}}(new class{constructor(){this.root=m(["app","container"]),document.body.append(this.root.getNode()),document.body.setAttribute("data-theme","light")}createLayout(){this.root.destroyChildren();const t=new S,e=new Z,r=new k;this.root.appendChildren([t,e,r])}}).createLayout()})()})();