(()=>{"use strict";var e={385:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},875:(e,t,s)=>{e.exports=s.p+"images/favicon-32x32.d0a6258a.png"}},t={};function s(i){var a=t[i];if(void 0!==a)return a.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,s),n.exports}s.m=e,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var a=i.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=i[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),s.b=document.baseURI||self.location.href;var i={};(()=>{s.r(i);var e,t,a,n,o=s(385),r=s.n(o),l=new URL(s(875),s.b);r()(l);class d{constructor({tag:e="div",classNames:t=[],text:s=""},...i){this.children=[];const a=document.createElement(e);a.classList.add(...t),a.textContent=s,this.node=a,i&&this.appendChildren(i)}append(e){this.children.push(e),this.node.append(e.getNode())}appendChildren(e){e.forEach((e=>{this.append(e)}))}getNode(){return this.node}getChildren(){return this.children}setTextContent(e){this.node.textContent=e}setAttribute(e,t){this.node.setAttribute(e,t)}removeAttribute(e){this.node.removeAttribute(e)}addClass(e){this.node.classList.add(e)}removeClass(e){this.node.classList.remove(e)}toggleClass(e){this.node.classList.toggle(e)}addListener(e,t,s=!1){this.node.addEventListener(e,t,s)}removeListener(e,t,s=!1){this.node.removeEventListener(e,t,s)}destroyChildren(){this.children.forEach((e=>{e.destroy()})),this.children.length=0}destroy(){this.destroyChildren(),this.node.remove()}}!function(e){e.PLACEHOLDER="placeholder",e.TYPE="type",e.NAME="name",e.ID="id",e.FOR="for",e.REQUIRED="required",e.ACTION="action",e.DISABLED="disabled",e.CHECKED="checked",e.VALUE="value",e.SELECTED="selected"}(e||(e={})),function(e){e.LOGIN="login",e.START_PAGE="start page",e.MAIN_PAGE="main page",e.STATISTIC_PAGE="statistic page"}(t||(t={})),function(e){e.SRC="src",e.ALT="alt"}(a||(a={})),function(e){e.HREF="href",e.TARGET="target"}(n||(n={}));class c extends d{constructor({classNames:t,id:s,type:i="text",name:a,placeholder:n,required:o,checked:r,onChange:l}){super({tag:"input",classNames:t}),this.setAttribute(e.ID,s),this.setAttribute(e.TYPE,i),this.setAttribute(e.NAME,a),n&&this.setAttribute(e.PLACEHOLDER,n),r&&this.setAttribute(e.CHECKED,r),o&&this.setAttribute(e.REQUIRED,o),l&&(this.onChange=l,this.addListener("input",this.onChange))}destroy(){this.onChange&&(this.removeListener("input",this.onChange),super.destroy())}}class h extends d{constructor({classNames:e,text:t,onClick:s}){super({tag:"button",classNames:e,text:t}),s&&(this.onClick=s,this.addListener("click",this.onClick))}destroy(){this.onClick&&(this.removeListener("click",this.onClick),super.destroy())}}const u=(e,...t)=>new d({tag:"div",classNames:e},...t),m=(e,t)=>new d({tag:"p",classNames:e,text:t}),p=(e,t)=>new d({tag:"h1",classNames:e,text:t}),g=(e,t)=>new d({tag:"h2",classNames:e,text:t}),S=(e,t)=>new d({tag:"span",classNames:e,text:t}),v=(e,t,s,i,a,n)=>new c({classNames:e,id:t,name:s,placeholder:i,required:a,onChange:n}),_=(e,t)=>new d({tag:"label",classNames:e,text:t}),A=(e,t,s)=>new h({classNames:e,text:t,onClick:s}),C=e=>new d({tag:"img",classNames:e}),L=(e,t)=>new d({tag:"li",classNames:e,text:t}),b=e=>new d({tag:"a",classNames:e});class E extends d{constructor(e,t){super({tag:"header",classNames:["Header-module_header_uNX8Ji"]},m(["Header-module_header-title_Ryd7lg"],"RSS Puzzle")),this.setAppState=e,this.currentPage=t,this.setContent()}setContent(){const e=A(["btn"],"Log out",(()=>{document.body.classList.remove("background"),localStorage.clear(),this.setAppState(t.LOGIN)}));this.currentPage!==t.LOGIN&&this.append(e)}}const w=s.p+"images/school-logo.ad178c0d.svg",G=s.p+"images/github-logo.1bc6258a.svg",f="footer-module_link_DKbGIh",k="footer-module_img_MrQMNV";class I extends d{constructor(){super({tag:"footer",classNames:["footer-module_footer_rlM2_G"]}),this.setBlock()}setBlock(){const e=u(["footer-module_copyright_JpZXSY"]),t=b([f]),s=b([f]),i=S(["copy"],"Â© 2024, by Hrybach Oleksiy"),o=C([k]),r=C([k]);t.setAttribute(n.HREF,"https://github.com/hrybach-oleksiy"),t.setAttribute(n.TARGET,"_blank"),s.setAttribute(n.HREF,"https://rs.school/js/"),s.setAttribute(n.TARGET,"_blank"),o.setAttribute(a.SRC,G),o.setAttribute(a.ALT,"GitHub Logo"),r.setAttribute(a.SRC,w),r.setAttribute(a.ALT,"RS School Logo"),t.append(o),s.append(r),e.appendChildren([t,s,i]),this.append(e)}}function x(e){if(null==e)throw new Error(`${e} is not defined`)}const y="LoginForm-module_text-field_WlUvxF",T="LoginForm-module_label_JkYZtE",D="LoginForm-module_input_ROTlgw",N="LoginForm-module_valid_dcWSla",P="LoginForm-module_invalid_iqPvO5",B="LoginForm-module_hidden_ZUa5ky",O="LoginForm-module_name-error_H3ODgh",H="LoginForm-module_surname-error_iPSbxC";class R extends d{constructor(s){super({tag:"form",classNames:["LoginForm-module_form_dZw0nL"]}),this.loginButton=A(["button","btn"],"Login"),this.isNameValid=!1,this.isSurnameValid=!1,this.setAttribute(e.ACTION,""),this.setForm(),this.addListener("submit",(e=>{e.preventDefault(),this.saveFormData(),this.clearForm(),this.destroy(),s&&s(t.START_PAGE)}))}setForm(){const t=p(["form__title","title"],"Login"),s=_([T],"Name"),i=_([T],"Surname"),a=u([O,B]),n=u([H,B]);this.nameInput=v([D],"name","name","Enter your Name","true",(e=>{this.validateName(e)})),this.surnameInput=v([D],"surname","surname","Enter your Surname","true",(e=>{this.validateSurname(e)})),s.setAttribute(e.FOR,"name"),i.setAttribute(e.FOR,"surname");const o=u([y],s,this.nameInput,a),r=u([y],i,this.surnameInput,n);this.loginButton.setAttribute(e.DISABLED,"true"),this.appendChildren([t,o,r,this.loginButton])}toggleButtonState(){this.isNameValid&&this.isSurnameValid?this.loginButton.removeAttribute(e.DISABLED):this.loginButton.setAttribute(e.DISABLED,"true")}toggleInputState(e,t,s){t.classList.toggle(N,e),t.classList.toggle(P,!e),"name"===s&&(this.isNameValid=e),"surname"===s&&(this.isSurnameValid=e),0===t.value.length&&(t.classList.remove(N),t.classList.remove(P),"name"===s&&(this.isNameValid=!1),"surname"===s&&(this.isSurnameValid=!1)),this.toggleButtonState()}validateName(e){const t=e.target,s=R.validateForm(t,`.${O}`,3);this.toggleInputState(s,t,t.name)}validateSurname(e){const t=e.target,s=R.validateForm(t,`.${H}`,4);this.toggleInputState(s,t,t.name)}static isFirstLetterUppercase(e){return/^[A-Z]/.test(e)}static validateForm(e,t,s){const i=e.value,a=document.querySelector(t);if(x(a),""===i.trim())return R.hideErrorMessage(a),!1;if(!/^[A-Za-z-]+$/.test(i))return R.showErrorMessage(a,'Field only accept English alphabet letters and the hyphen (" - ") symbol'),!1;if(!R.isFirstLetterUppercase(i))return R.showErrorMessage(a,"First letter of the field must be in uppercase"),!1;if(i.length<s){const e=`Minimum length of the ${3===s?"first name":"surname"} is ${s} characters`;return R.showErrorMessage(a,e),!1}return R.hideErrorMessage(a),!0}static showErrorMessage(e,t){const s=e;e.classList.remove(B),s.textContent=t}static hideErrorMessage(e){const t=e;e.classList.add(B),t.textContent=""}saveFormData(){const e=this.nameInput?.getNode(),t=this.surnameInput?.getNode();x(e),x(t);const s={name:e.value,surname:t.value},i=JSON.stringify(s);localStorage.setItem("userData",i)}clearForm(){this.getNode().reset(),this.nameInput?.removeClass(N),this.surnameInput?.removeClass(N)}}class W extends d{constructor(e,t){super({classNames:["StartScreen-module_start-screen_Iig9zn"]}),this.userData=e,this.setAppState=t,this.SetPage()}SetPage(){const e=p(["StartScreen-module_title_Hg2suX"],"RSS PUZZLE GAME"),t=A(["btn","StartScreen-module_button_oVPcdU"],"Start Game",(()=>{this.startGame()})),s=m(["StartScreen-module_description_p9se0K"],"RSS Puzzle is an interactive mini-game aimed at enhancing English language skills. Players assemble sentences from jumbled words. The game integrates various levels of difficulty, hint options, and a unique puzzle-like experience with artwork."),i=this.getUserData(),a=m(["StartScreen-module_user-title_SZEi2q","StartScreen-module_fade-in_X4J4an"],`Hello ${i.surname} ${i.name}!`),n=u(["StartScreen-module_wrapper_ihi0Qs"],e,s);document.body.classList.add("background"),this.appendChildren([n,a,t])}getUserData(){const e=this.userData?.name,t=this.userData?.surname;return{name:e,surname:t}}startGame(){this.setAppState&&this.setAppState(t.MAIN_PAGE)}}class M extends d{constructor(t,s){super({tag:"div",classNames:["result-block"]}),this.rows=10,this.setAttribute(e.ID,"result"),this.stringLength=t,this.guessedSentences=s,this.setPage()}setPage(){const t=this.createTemplates();for(let s=0;s<this.rows;s+=1){const i=u(["result-row"]);i.setAttribute(e.ID,`row-${s+1}`),s===this.guessedSentences.length?i.appendChildren(t):this.addGuessedSentence(i,s),this.append(i)}}createTemplates(){const t=[];for(let s=0;s<this.stringLength;s+=1){const i=u(["result-template"]);i.setAttribute(e.ID,`template-${String(s+1)}`),t.push(i)}return t}createParts(e){return this.guessedSentences[e]?.map((e=>S(["part"],e)))}addGuessedSentence(t,s){const i=this.createParts(s);for(let a=0;a<this.guessedSentences[s]?.length;a+=1){const s=u(["result-template"]);i[a].addClass("match"),s.setAttribute(e.ID,`template-${String(a+1)}`),s.append(i[a]),t.append(s)}}}class F extends d{constructor(t,s){super({tag:"div",classNames:["source-data"]}),this.imageWidth=0,this.imageHeights=0,this.setAttribute(e.ID,"source"),this.words=t,this.imageSrc=s,this.getImageSize()}createParts(){return this.words.map(((t,s)=>{const i=S(["part"],t);return i.setAttribute(e.ID,`part-${String(s+1)}`),i}))}addTemplates(){const t=this.createParts();for(let s=0;s<this.words.length;s+=1){const i=u(["source-template"]);i.setAttribute(e.ID,`template-${String(s+1)}`),i.append(t[s]),this.append(i)}}static splitImageIntoChunks(e,t,s,i){console.log(e),console.log(t),console.log(s),console.log(i);const a=[],n=Math.floor(e/i),o=Math.floor(t/s);for(let r=0;r<s;r+=1)for(let l=0;l<i;l+=1){const d=l*n,c=r*o,h=l===i-1?e-d:n,u=r===s-1?t-c:o;a.push({startX:d,startY:c,width:h,height:u})}return a}static loadImageAndGetSize(e){return new Promise(((t,s)=>{const i=new Image;i.onload=()=>{t({width:i.width,height:i.height})},i.onerror=e=>{s(e)},i.src=e}))}getImageSize(){const e=`https://raw.githubusercontent.com/rolling-scopes-school/rss-puzzle-data/main/images/${this.imageSrc}`;F.loadImageAndGetSize(e).then((({width:e,height:t})=>{this.imageWidth=e,this.imageHeights=t,this.addTemplates()})).catch((e=>{console.error("Image Loading Error",e)}))}}class $ extends d{constructor(e,t,s){super({tag:"div",classNames:["Hint-module_hint-wrapper_spR6MU"]}),this.title=e,this.inputState=t,this.props=s,this.setBlock()}setBlock(){const t=g(["Hint-module_title__DKGxp"],this.title),s=_(["Hint-module_switch_U1dTg4"],""),i=new c(this.props),a=S(["Hint-module_slider_cyWNo5","Hint-module_round_PtWpIh"],"");this.inputState?i.setAttribute(e.CHECKED,"true"):i.removeAttribute(e.CHECKED),s.appendChildren([i,a]),this.appendChildren([t,s])}}class z extends d{constructor(e,t,s){super({tag:"div",classNames:["GameSelect-module_levels_QLfEEP"]}),this.title=e,this.optionsCount=t,this.optionValue=s,this.setBlock()}setBlock(){const t=_(["select-label"],this.title),s=new d({tag:"select",classNames:["GameSelect-module_select_qlNY69"]});for(let t=1;t<=this.optionsCount;t+=1){const a=(i=[`${this.title.toLowerCase()}-option`,"GameSelect-module_option_J1jFrQ"],new d({tag:"option",classNames:i,text:`${t}`}));a.setAttribute(e.VALUE,`${t}`),t===this.optionValue&&a.setAttribute(e.SELECTED,"true"),s.append(a)}var i;this.appendChildren([t,s])}}const q=s.p+"images/audio-icon.584625dc.svg",V=s.p+"images/audio-playing.047c8570.svg",J={"game-header-wrapper":"GameHeader-module_game-header-wrapper_hk2bf7",gameHeaderWrapper:"GameHeader-module_game-header-wrapper_hk2bf7","game-levels-wrapper":"GameHeader-module_game-levels-wrapper__WX2R5",gameLevelsWrapper:"GameHeader-module_game-levels-wrapper__WX2R5","hints-wrapper":"GameHeader-module_hints-wrapper_HVVMq9",hintsWrapper:"GameHeader-module_hints-wrapper_HVVMq9","audio-icon-wrapper":"GameHeader-module_audio-icon-wrapper_haPsAl",audioIconWrapper:"GameHeader-module_audio-icon-wrapper_haPsAl","audio-img":"GameHeader-module_audio-img_oIvq0k",audioImg:"GameHeader-module_audio-img_oIvq0k",translation:"GameHeader-module_translation_fQtU9h",hidden:"GameHeader-module_hidden_n5hWNH","game-levels-title":"GameHeader-module_game-levels-title_Q9arFV",gameLevelsTitle:"GameHeader-module_game-levels-title_Q9arFV",count:"GameHeader-module_count_rYZcEP",show:"GameHeader-module_show_zeqCOz","level-1":"GameHeader-module_level-1__EBSn5",level1:"GameHeader-module_level-1__EBSn5","level-2":"GameHeader-module_level-2_Re6lo5",level2:"GameHeader-module_level-2_Re6lo5","level-3":"GameHeader-module_level-3_EJuH9e",level3:"GameHeader-module_level-3_EJuH9e","level-4":"GameHeader-module_level-4_LLxcwI",level4:"GameHeader-module_level-4_LLxcwI","level-5":"GameHeader-module_level-5_kvt37c",level5:"GameHeader-module_level-5_kvt37c","level-6":"GameHeader-module_level-6_H3C2x2",level6:"GameHeader-module_level-6_H3C2x2"};class U extends d{constructor(e,t,s,i,n,o,r,l){super({tag:"div",classNames:[J["game-header-wrapper"]]}),this.isPlaying=!1,this.audioIcon=C([J["audio-img"]]),this.handleHintChange=e=>{const t=e.target,s=t.checked,i=t.name,a=U.getHintsState();let n=a?.translation,o=a?.pronunciation;s?this.setHintState(i,!0):this.setHintState(i,!1),"translation"===i&&(n=s),"pronunciation"===i&&(o=s);const r={translation:n,pronunciation:o},l=JSON.stringify(r);localStorage.setItem("hintsState",l)},this.handleAudioIconClick=e=>{const t=new Audio;this.isPlaying||(this.audioIcon.setAttribute(a.SRC,V),t.src=`https://raw.githubusercontent.com/rolling-scopes-school/rss-puzzle-data/main/${e}`,t.play(),this.isPlaying=!0,t.onended=()=>{this.isPlaying=!1,this.audioIcon.setAttribute(a.SRC,q)})},this.translation=e,this.hintsState=t,this.audioExample=s,this.currentLevel=o,this.onLevelChange=i,this.onRoundChange=n,this.roundsCount=r,this.currentRound=l,this.setBlock()}setBlock(){this.destroyChildren();const e=this.setTranslationBlock(),t=this.setHintsBlock(),s=this.setGameLevelsBlock(),i=this.setAudioIconBlock(),a=this.setLevelsTitleBlock();this.appendChildren([s,t,a,i,e]),setTimeout((()=>{document.querySelectorAll(`.${J.count}`).forEach((e=>{e.classList.add(J.show)}))}),0)}setLevelsTitleBlock(){const e=S([J.count],String(this.currentLevel)),t=S([J.count],String(this.currentRound)),s=S([],"Level: "),i=S([],",    Round: "),a=g([J["game-levels-title"]],""),n=U.setDifficultyColor(this.currentLevel);return e.addClass(`${J[n]}`),t.addClass(`${J[n]}`),a.appendChildren([s,e,i,t]),a}setAudioIconBlock(){const t=u([J["audio-icon-wrapper"]]);return this.audioIcon.setAttribute(a.SRC,q),this.audioIcon.setAttribute(a.ALT,"Audio Icon"),this.audioIcon.setAttribute(e.ID,"audio-icon"),this.audioIcon.addListener("click",(()=>{this.isPlaying||this.handleAudioIconClick(this.audioExample)})),this.hintsState.pronunciation?this.audioIcon.removeClass("hidden"):this.audioIcon.addClass("hidden"),t.append(this.audioIcon),t}setGameLevelsBlock(){const e=u([J["game-levels-wrapper"]]),t=new z("Level",6,this.currentLevel),s=new z("Round",this.roundsCount,this.currentRound);return e.appendChildren([t,s]),t.addListener("change",this.onLevelChange),s.addListener("change",this.onRoundChange),e}setHintsBlock(){const e={id:"translation",name:"translation",type:"checkbox",onChange:this.handleHintChange},t={id:"pronunciation",name:"pronunciation",type:"checkbox",onChange:this.handleHintChange},s=new $("Translation",this.hintsState.translation,e),i=new $("Pronunciation ",this.hintsState.pronunciation,t),a=u([J["hints-wrapper"]]);return a.appendChildren([s,i]),a}setTranslationBlock(){const t=m([J.translation],this.translation);return t.setAttribute(e.ID,"translation-text"),this.hintsState.translation?t.removeClass("hidden"):t.addClass("hidden"),t}static setDifficultyColor(e){switch(e){case 1:default:return"level-1";case 2:return"level-2";case 3:return"level-3";case 4:return"level-4";case 5:return"level-5";case 6:return"level-6"}}setHintState(e,t){this.hintsState[e]=t,this.setBlock()}static getHintsState(){const e=localStorage.getItem("hintsState");if(e){const t=JSON.parse(e);return{translation:t.translation,pronunciation:t.pronunciation}}return null}}const j="MainPage-module_remove-animation_inKO2G",Q="MainPage-module_hidden_KdHWHW";class X extends d{constructor(s){super({tag:"section",classNames:["MainPage-module_main-page_yLTCA5"]}),this.level=1,this.round=1,this.sentence=0,this.roundsCount=0,this.words=[],this.stringLength=0,this.correctWordOrder=[],this.guessedWordOrder=[],this.isOrderCorrect=!1,this.guessedSentences=[],this.checkButton=A(["check-btn","btn"],"Check Answer"),this.autocompleteButton=A(["complete-btn","btn"],"Complete Sentence"),this.resultsButton=A(["results-btn","btn",Q],"Results"),this.guessedElements=[],this.translation="",this.audioExample="",this.guessedAudioExamples=[],this.noteGuessedAudioExamples=[],this.hintsState={translation:!0,pronunciation:!0},this.guessedToStatistic=[],this.notGuessedToStatistic=[],this.isSentenceAutocompleted=!1,this.completedRounds=[],this.completedLevels=[],this.handleWordClick=t=>{const s=t.target,i=document.querySelectorAll(`#row-${this.sentence+1} .result-template`),a=document.querySelectorAll(".source-template"),n=Number(s.getAttribute(e.ID)?.slice(-1));let o=0;if(s.closest("#result")&&s.classList.contains("part")){const t=document.querySelectorAll(".result-template .part");s.classList.add(j),t.forEach((e=>{e.classList.remove("match"),e.classList.remove("mismatch")})),a.forEach((t=>{const i=Number(t.getAttribute(e.ID)?.slice(-1));n===i&&(a[i-1].append(s),this.removeWordsFromGuessed(s))})),setTimeout((()=>{s.classList.remove(j)}),0)}else s.closest("#source")&&s.classList.contains("part")&&(s.classList.add(j),this.addWordsToGuessed(s),i[o].append(s),o+=1,o===this.stringLength&&(o=0),setTimeout((()=>{s.classList.remove(j)}),0));s.classList.contains("btn")||this.isOrderCorrect||this.checkWin(),this.enableCheckButton()},this.handleLevelSelect=e=>{const t=e.target,s=Number(t.value);this.level=s,this.isOrderCorrect=!1,this.guessedElements=[],this.guessedWordOrder=[],this.clearGuessedData(),this.round=1,this.sentence=0,this.fetchData(this.level),this.saveLevelState(s),localStorage.removeItem("gameState")},this.handleRoundSelect=e=>{const t=e.target,s=Number(t.value);this.round=s,this.isOrderCorrect=!1,this.guessedElements=[],this.guessedWordOrder=[],this.clearGuessedData(),this.sentence=0,this.fetchData(this.level),this.saveRoundState(s),localStorage.removeItem("gameState")},this.checkGuess=()=>{for(let e=0;e<this.correctWordOrder.length;e+=1){const t=this.correctWordOrder[e],s=this.guessedWordOrder[e],i=this.guessedElements[e];t===s?(i.classList.add("match"),i.classList.remove("mismatch")):(i.classList.remove("match"),i.classList.add("mismatch"))}this.isOrderCorrect&&(this.checkButton.removeListener("click",this.checkGuess),this.checkButton.setTextContent("Continue"),this.checkButton.addListener("click",this.handleContinueButton),X.showTranslationByLevelComplete(),this.autocompleteButton.setAttribute(e.DISABLED,"true"),this.isSentenceAutocompleted||this.addGuessedToStatistic(),9===this.sentence)&&(this.autocompleteButton.getNode().remove(),this.resultsButton.removeClass(Q),X.saveGameState(this.guessedSentences,this.guessedToStatistic,this.notGuessedToStatistic,this.sentence,this.levelData,this.guessedAudioExamples,this.noteGuessedAudioExamples,this.completedRounds,this.completedLevels))},this.handleContinueButton=()=>{this.sentence+=1,10===this.sentence&&(console.log("next round starts"),this.completedRounds.push(this.round),this.round+=1,this.sentence=0,this.clearGuessedData()),this.round===this.roundsCount+1&&(console.log("next level starts"),this.completedLevels.push(this.level),this.completedRounds=[],this.level+=1,this.round=1,this.sentence=0,this.clearGuessedData()),this.isOrderCorrect=!1,this.guessedElements=[],this.guessedWordOrder=[],this.checkButton.removeListener("click",this.handleContinueButton),X.saveGameState(this.guessedSentences,this.guessedToStatistic,this.notGuessedToStatistic,this.sentence,this.levelData,this.guessedAudioExamples,this.noteGuessedAudioExamples,this.completedRounds,this.completedLevels),9===this.sentence&&(this.saveRoundState(),this.saveLevelState()),this.level>6&&(this.completedLevels=[],this.level=1),this.fetchData(this.level)},this.autocompleteSentence=()=>{const t=document.querySelectorAll(`#row-${this.sentence+1} .result-template`),s=document.querySelectorAll(".source-template");this.guessedWordOrder=[],this.correctWordOrder.forEach((e=>{const t=S(["part"],e);this.addWordsToGuessed(t.getNode())})),t.forEach(((e,t)=>{const s=e,i=S(["part"],this.correctWordOrder[t]),a=i.getNode();i.addClass("match"),a.classList.add(j),s.innerHTML="",e.append(a),setTimeout((()=>{a.classList.remove(j)}),0)})),s.forEach((e=>{e.innerHTML=""})),this.isSentenceAutocompleted=!0,this.checkWin(),this.checkGuess(),this.enableCheckButton(),this.isOrderCorrect=!0,this.autocompleteButton.setAttribute(e.DISABLED,"true"),X.showTranslationByLevelComplete(),X.showAudioByLevelComplete(),this.addNotGuessedToStatistic()},this.openStatisticPage=()=>{X.saveGameState(this.guessedSentences,this.guessedToStatistic,this.notGuessedToStatistic,this.sentence,this.levelData,this.guessedAudioExamples,this.noteGuessedAudioExamples,this.completedRounds,this.completedLevels),this.setAppState&&this.setAppState(t.STATISTIC_PAGE),this.handleContinueButton()},this.setAppState=s,this.getGameState(),this.addListener("click",this.handleWordClick)}setPage(){this.destroyChildren();const t=u(["MainPage-module_btn-wrapper_gXaWbl"]),s=new U(this.translation,this.hintsState,this.audioExample,this.handleLevelSelect,this.handleRoundSelect,this.level,this.roundsCount,this.round);this.resultBlock=new M(this.stringLength,this.guessedSentences),this.sourceBlock=new F(this.words,this.levelData.imageSrc),this.checkButton.setAttribute(e.DISABLED,"true"),this.checkButton.setTextContent("Check Answer"),this.checkButton.addListener("click",this.checkGuess),this.autocompleteButton.addListener("click",this.autocompleteSentence),this.autocompleteButton.removeAttribute(e.DISABLED),this.resultsButton.addListener("click",this.openStatisticPage),this.resultsButton.addClass(Q),this.isSentenceAutocompleted=!1,t.appendChildren([this.checkButton,this.autocompleteButton,this.resultsButton]),this.appendChildren([s,this.resultBlock,this.sourceBlock,t])}getWords(e,t){const{rounds:s,roundsCount:i}=this.gameData,a=s[e],n=a.words[t],o=n.textExample,r=n.textExampleTranslate,l=n.audioExample;return this.correctWordOrder=o.split(" "),this.translation=r,this.roundsCount=i,this.audioExample=l,this.levelData={name:a.levelData.name,cutSrc:a.levelData.cutSrc,author:a.levelData.author,year:a.levelData.year,imageSrc:a.levelData.imageSrc},console.log(this.correctWordOrder),o}shuffleWords(){const e=this.getWords(this.round-1,this.sentence).split(" ");for(let t=e.length-1;t>0;t-=1){const s=Math.floor(Math.random()*(t+1)),i=e[t];e[t]=e[s],e[s]=i}this.words=e,this.stringLength=e.length}async fetchData(e){try{const t=await fetch(`https://raw.githubusercontent.com/rolling-scopes-school/rss-puzzle-data/main/data/wordCollectionLevel${e}.json`);if(!t.ok)throw new Error("Failed to fetch data");this.gameData=await t.json(),this.shuffleWords(),this.getHintsState(),this.setPage()}catch(e){console.error("Error fetching data:",e)}}addWordsToGuessed(e){const t=e.textContent;this.guessedWordOrder.push(t),this.guessedElements.push(e)}removeWordsFromGuessed(e){const t=e.textContent,s=this.guessedWordOrder.indexOf(t),i=this.guessedElements.indexOf(e);s>=0&&(this.guessedWordOrder.splice(s,1),this.guessedElements.splice(i,1))}checkWin(){this.correctWordOrder.length!==this.guessedWordOrder.length&&(this.isOrderCorrect=!1),this.isOrderCorrect=this.correctWordOrder.every(((e,t)=>e===this.guessedWordOrder[t])),this.addGuessedSentences()}enableCheckButton(){const e=this.correctWordOrder.length===this.guessedWordOrder.length;X.changeButtonState(this.checkButton,e)}addGuessedSentences(){this.isOrderCorrect?this.guessedSentences.push(this.correctWordOrder):this.guessedSentences.splice(this.sentence,1)}addNotGuessedToStatistic(){this.isOrderCorrect?(this.notGuessedToStatistic.push(this.correctWordOrder),this.noteGuessedAudioExamples.push(this.audioExample)):(this.notGuessedToStatistic.splice(this.sentence,1),this.noteGuessedAudioExamples.slice(this.sentence,1))}addGuessedToStatistic(){this.isOrderCorrect?(this.guessedToStatistic.push(this.correctWordOrder),this.guessedAudioExamples.push(this.audioExample)):(this.guessedToStatistic.splice(this.sentence,1),this.guessedAudioExamples.slice(this.sentence,1))}static changeButtonState(t,s){s?t.removeAttribute(e.DISABLED):t.setAttribute(e.DISABLED,"true")}static showTranslationByLevelComplete(){const e=document.querySelector("#translation-text");e?.classList.remove("hidden")}static showAudioByLevelComplete(){const e=document.querySelector("#audio-icon");e?.classList.remove("hidden")}getHintsState(){const e=localStorage.getItem("hintsState");if(e){const t=JSON.parse(e);this.hintsState={translation:t.translation,pronunciation:t.pronunciation}}}saveLevelState(e){const t=document.querySelector(".level-option[selected='true']");let s=Number(t.value);6===s&&this.round===this.roundsCount&&(s=1),this.round===this.roundsCount&&this.level<6&&(s+=1);const i={level:e||s},a=JSON.stringify(i);localStorage.setItem("levelState",a)}saveRoundState(e){const t=document.querySelector(".round-option[selected='true']");let s=Number(t.value)+1;s===this.roundsCount+1&&(s=1);const i={round:e||s},a=JSON.stringify(i);localStorage.setItem("roundState",a)}static saveGameState(e,t,s,i,a,n,o,r,l){const d={guessedSentences:e,guessedToStatistic:t,notGuessedToStatistic:s,sentenceNumber:i,artwork:a,guessedAudioExamples:n,notGuessedAudioExamples:o,completedRounds:r,completedLevels:l},c=JSON.stringify(d);localStorage.setItem("gameState",c)}getGameState(){const e=localStorage.getItem("levelState"),t=localStorage.getItem("roundState"),s=localStorage.getItem("gameState");if(e){const t=JSON.parse(e);this.level=t.level}else this.level=1;if(t){const e=JSON.parse(t);this.round=e.round}else this.round=1;if(s){const e=JSON.parse(s);this.guessedSentences=e.guessedSentences,this.guessedToStatistic=e.guessedToStatistic,this.notGuessedToStatistic=e.notGuessedToStatistic,this.sentence=e.sentenceNumber,this.completedRounds=e.completedRounds,this.completedLevels=e.completedLevels}else this.guessedSentences=[],this.guessedToStatistic=[],this.notGuessedToStatistic=[],this.sentence=0,this.completedRounds=[],this.completedLevels=[];this.fetchData(this.level)}clearGuessedData(){this.guessedSentences=[],this.guessedToStatistic=[],this.notGuessedToStatistic=[],this.guessedAudioExamples=[],this.noteGuessedAudioExamples=[]}}const Y=s.p+"images/audio-icon-statistic.df226349.svg",Z=s.p+"images/audio-icon-statistic-playing.f1f8bf92.svg",K="StatisticPage-module_list-item_LBv5Ot",ee="StatisticPage-module_title-wrapper_LnO0z5",te="StatisticPage-module_count_uxYGJN";class se extends d{constructor(e){super({tag:"section",classNames:["StatisticPage-module_statistic_Alkt_F"]}),this.guessedSentences=[],this.notGuessedSentences=[],this.artworkData=null,this.guessedAudioExamples=[],this.notGuessedAudioExamples=[],this.isPlaying=!1,this.continueGame=()=>{this.setAppState&&this.setAppState(t.MAIN_PAGE)},this.handleAudioIconClick=(e,t)=>{const s=new Audio;this.isPlaying||(t.setAttribute(a.SRC,Z),s.src=`https://raw.githubusercontent.com/rolling-scopes-school/rss-puzzle-data/main/${e}`,s.play(),this.isPlaying=!0,s.onended=()=>{this.isPlaying=!1,t.setAttribute(a.SRC,Y)})},this.setAppState=e,this.getGameState(),this.SetPage()}SetPage(){const e=u(["StatisticPage-module_artwork-block_aInBl6"]),t=u(["StatisticPage-module_miniature_HRSXXB"]),s=C(["img"]),i=u(["text-block"]),n=S(["author-name"],`${this.artworkData?.author} - `),o=S(["miniature-name"],`${this.artworkData?.name} `),r=S(["year"],`(${this.artworkData?.year})`);s.setAttribute(a.SRC,`https://raw.githubusercontent.com/rolling-scopes-school/rss-puzzle-data/main/images/${this.artworkData?.cutSrc}`),s.setAttribute(a.ALT,`${this.artworkData?.name} Miniature`),t.append(s),i.appendChildren([n,o,r]),e.appendChildren([t,i]);const l=u(["StatisticPage-module_not-guessed_OTotiO"]),d=g(["title"],"I don't know"),c=S([te,"StatisticPage-module_red_xfLSV9"],String(this.notGuessedSentences.length)),h=u([ee]),m=this.createSentencesList(this.notGuessedSentences,this.notGuessedAudioExamples);h.appendChildren([d,c]),l.appendChildren([h,m]);const p=u(["StatisticPage-module_guessed_c159_7"]),v=g(["title"],"I know"),_=S([te,"StatisticPage-module_green__Ro3QY"],String(this.guessedSentences.length)),L=u([ee]),b=this.createSentencesList(this.guessedSentences,this.guessedAudioExamples);L.appendChildren([v,_]),p.appendChildren([L,b]);const E=A(["btn","StatisticPage-module_button_YMkbk7"],"Continue Game",this.continueGame);document.body.classList.add("background"),this.appendChildren([e,l,p,E])}getGameState(){const e=localStorage.getItem("gameState");if(e){const t=JSON.parse(e);this.guessedSentences=t.guessedToStatistic,this.notGuessedSentences=t.notGuessedToStatistic,this.artworkData=t.artwork,this.guessedAudioExamples=t.guessedAudioExamples,this.notGuessedAudioExamples=t.notGuessedAudioExamples}else this.guessedSentences=[],this.notGuessedSentences=[],this.artworkData=null,this.guessedAudioExamples=[],this.notGuessedAudioExamples=[]}createSentencesList(e,t){const s=new d({tag:"ul",classNames:["StatisticPage-module_list_N77hr9"]});return e?e.forEach(((e,i)=>{const n=L([K],e.join(" ")),o=u(["StatisticPage-module_audio-icon-wrapper_sdwC5_"]),r=C(["StatisticPage-module_audio-img_iTx0Ne"]);r.setAttribute(a.SRC,Y),o.addListener("click",(()=>{this.handleAudioIconClick(t[i],r)})),o.append(r),n.append(o),s.append(n)})):s.append(L([K],"")),s}}class ie extends d{constructor(e,t,s){super({tag:"main",classNames:["Main-module_main_d2LaAM"]}),this.userData=e,this.setAppState=t,this.page=s,this.setPage()}setPage(){if(this.destroyChildren(),this.page===t.START_PAGE){const e=new W(this.userData,this.setAppState);this.append(e)}if(this.page===t.LOGIN){const e=new R(this.setAppState);this.append(e)}if(this.page===t.MAIN_PAGE){const e=new X(this.setAppState);this.append(e)}if(this.page===t.STATISTIC_PAGE){const e=new se(this.setAppState);this.append(e)}}}(new class{constructor(){this.root=u(["app","container"]),this.userData=null,this.appState={currentPage:t.LOGIN},this.handleAppState=e=>{this.appState.currentPage=e,this.getUserData(),this.createLayout()},document.body.append(this.root.getNode()),document.body.setAttribute("data-theme","light"),this.getUserData(),this.userData&&(this.appState.currentPage=t.START_PAGE)}createLayout(){this.root.destroyChildren();const e=new E(this.handleAppState,this.appState.currentPage),t=new ie(this.userData,this.handleAppState,this.appState.currentPage),s=new I;this.root.appendChildren([e,t,s])}getUserData(){const e=localStorage.getItem("userData");if(e){const t=JSON.parse(e);this.userData={name:t.name,surname:t.surname}}else this.userData=null}}).createLayout()})()})();